$(document).ready(function(){var m=$("#selected-language")[0].innerHTML,r=window.location.pathname,n={en:{NAME_MIN:"Must have at least 3 characters",NAME_MAX:"Can have at most 50 characters",USERNAME_MIN:"Must have at least 3 characters",USERNAME_MAX:"Can have at most 50 characters",EMAIL:"This is not a valid email address",EMAIL_MAX:"Can have at most 50 characters",PASSWORD_MIN:"Must have at least 6 characters",BIOGRAPHY_MAX:"Can have at most 500 characters",TITLE_MAX:"Can have at most 500 characters",
DESCRIPTION_MAX:"Can have at most 500 characters",EMPTY:"This field is required",CHECKED:"This field is required",UNWATCH:"Unwatch",WATCH:"Watch",UNSTAR:"Unstar",STAR:"Star",MATCH:"This field must match the field above",AVATAR_FORMAT:"Unfortunately, we only support PNG, GIF, or JPG pictures",AVATAR_SIZE:"Unfortunately, we only support pictures with up to 1 MB size",ADD_AVATAR:"Upload new picture",TOO_WEAK:"Too Weak",WEAK:"Weak",GOOD:"Good",STRONG:"Strong",DELETE_MODAL_MESSAGE:"Are you ABSOLUTELY sure?\nIf so, please type in the title of the tale to confirm.",
DELETE_MODAL_WRONG_TITLE:"Wrong tale title"},pt:{NAME_MIN:"Deve conter ao menos 3 caracteres",NAME_MAX:"Pode conter no m\u00e1ximo 50 caracters",USERNAME_MIN:"Deve conter ao menos 3 caracteres",USERNAME_MAX:"Pode conter no m\u00e1ximo 50 caracters",EMAIL:"Este n\u00e3o \u00e9 um email v\u00e1lido",EMAIL_MAX:"Pode conter no m\u00e1ximo 50 caracters",PASSWORD_MIN:"Deve conter ao menos 6 caracteres",BIOGRAPHY_MAX:"Pode conter no m\u00e1ximo 500 caracteres",TITLE_MAX:"Pode conter no m\u00e1ximo 500 caracteres",
DESCRIPTION_MAX:"Pode conter no m\u00e1ximo 500 caracteres",EMPTY:"Este campo \u00e9 obrigat\u00f3rio",CHECKED:"Este campo \u00e9 obrigat\u00f3rio",UNWATCH:"Parar de Seguir",WATCH:"Seguir",UNSTAR:"Tirar Recomenda\u00e7\u00e3o",STAR:"Recomendar",MATCH:"Este campo deve ser igual ao de cima",AVATAR_FORMAT:"Infelizmente, suportamos apenas imagens em PGN, GIF ou JPG",AVATAR_SIZE:"Infelizmente, suportamos apenas imagens com tamanho de at\u00e9 1 MB",ADD_AVATAR:"Enviar nova imagem",TOO_WEAK:"Muito fraca",
WEAK:"Fraca",GOOD:"Boa",STRONG:"Forte",DELETE_MODAL_MESSAGE:"Voc\u00ea tem certeza ABSOLUTA?\nSe sim, por favor digite o t\u00edtulo do conto para confirmar.",DELETE_MODAL_WRONG_TITLE:"T\u00edtulo do conto errado"}},p={name:[{type:"length[3]",prompt:n[m].NAME_MIN},{type:"maxLength[50]",prompt:n[m].NAME_MAX}],username:[{type:"length[3]",prompt:n[m].USERNAME_MIN},{type:"maxLength[50]",prompt:n[m].USERNAME_MAX}],email:[{type:"email",prompt:n[m].EMAIL},{type:"maxLength[50]",prompt:n[m].EMAIL_MAX}],password:[{type:"length[6]",
prompt:n[m].PASSWORD_MIN}],biography:[{type:"maxLength[500]",prompt:n[m].BIOGRAPHY_MAX}],title:[{type:"empty",prompt:n[m].EMPTY},{type:"maxLength[500]",prompt:n[m].TITLE_MAX}],description:[{type:"maxLength[500]",prompt:n[m].DESCRIPTION_MAX}],empty:[{type:"empty",prompt:n[m].EMPTY}],checked:[{type:"checked",prompt:n[m].CHECKED}],match:function(a){return[{type:"match["+a+"]",prompt:n[m].MATCH}]}},B=function(a){if(6>a.length)return 0;if(8>a.length)return 1;var c=0;/[a-z]/.test(a)&&++c;/[A-Z]/.test(a)&&
++c;/[0-9]/.test(a)&&++c;/[@#$%&\*\(\)!\-\+]/.test(a)&&++c;return 1==c?1:2==c?2:3},v=function(a,c,t){var b='<ul class="ui negative message" id="messages-list">';t&&(b='<ul class="ui positive message" id="messages-list">');for(t=a.length-1;0<=t;t--)b+="<li>"+a[t]+"</li>";b+="</ul>";$("#messages-list").remove();c.after(b)};$("#language-en, #language-pt").on("click",function(a){a.preventDefault();a=/\-(\w+)/.exec(this.id)[1];$.ajax({type:"get",url:"/set_language",datatype:"json",data:{language:a},success:function(a){window.location.reload(!0)},
error:function(a,t,b){console.log(a)}});return!1});if("/"===r){var A=$("#top-all"),y=$("#top-today"),z=$(".top-tales");A.on("click",function(a){y.removeClass("active");A.addClass("active");$.ajax({type:"get",url:"/get_ten_best_tales",datatype:"json",success:function(a){z.find("div").remove();z.append(a)},error:function(a,t,b){console.log(a)}})});y.on("click",function(a){A.removeClass("active");y.addClass("active");$.ajax({type:"get",url:"/get_ten_best_daily_tales",datatype:"json",success:function(a){z.find("div").remove();
z.append(a)},error:function(a,t,b){console.log(a)}})});y.trigger("click")}if(-1!==r.indexOf("join")){var C=$(".login"),u=$(".signup"),F=u.find(".password-strength");u.find('input[name="signup-password"]').on("keyup",function(a){a=B(this.value);F.removeClass();switch(a){case 0:F.addClass("ui yellow label").html(n[m].TOO_WEAK);break;case 1:F.addClass("ui green label").html(n[m].WEAK);break;case 2:F.addClass("ui blue label").html(n[m].GOOD);break;default:F.addClass("ui red label").html(n[m].STRONG)}});
C.find("form").form({username:{identifier:"login-username",rules:p.username},password:{identifier:"login-password",rules:p.password}},{inline:!0,onSuccess:function(){var a=$(this).find('input[type="password"]')[0],c=(new jsSHA(a.value,"TEXT")).getHash("SHA-256","HEX");a.value=c;$.ajax({type:this.method,url:this.action,data:new FormData(this),processData:!1,contentType:!1,success:function(a){window.location=a.url},error:function(a,c,b){v(a.responseJSON.error_list,C.find("h2"))}});return!1}});u.find("form").form({username:{identifier:"signup-username",
rules:p.username},email:{identifier:"signup-email",rules:p.email},password:{identifier:"signup-password",rules:p.password},repeat_password:{identifier:"signup-repeat-password",rules:p.match("signup-password")}},{inline:!0,onSuccess:function(){var a=$(this).find('input[name="signup-password"]')[0],c=a.value,c=(new jsSHA(c,"TEXT")).getHash("SHA-256","HEX");a.value=c;a=$(this).find('input[name="signup-repeat-password"]')[0];c=a.value;c=(new jsSHA(c,"TEXT")).getHash("SHA-256","HEX");a.value=c;$.ajax({type:this.method,
url:this.action,data:new FormData(this),processData:!1,contentType:!1,success:function(a){v([a.message],u.find("h2"),!0)},error:function(a,c,b){v(a.responseJSON.error_list,u.find("h2"))}});return!1}})}if(-1!==r.indexOf("password_reset")){var H=$(".password-reset form");H.form({email:{identifier:"password-reset-email",rules:p.email}},{inline:!0,onSuccess:function(){$.ajax({type:this.method,url:this.action,data:new FormData(this),processData:!1,contentType:!1,success:function(a){v([a.message],H.find("h1"),
!0)},error:function(a,c,b){v(a.responseJSON.error_list,H.find("h1"))}});return!1}})}if(-1!==r.indexOf("change_password")){var L=$(".change-password form");L.form({password:{identifier:"change-password-new-password",rules:p.password},repeat_password:{identifier:"change-password-confirm-new-password",rules:p.password}},{inline:!0,onSuccess:function(){var a=$(this).find('input[name="change-password-new-password"]')[0],c=a.value,c=(new jsSHA(c,"TEXT")).getHash("SHA-256","HEX");a.value=c;a=$(this).find('input[name="change-password-confirm-new-password"]')[0];
c=a.value;c=(new jsSHA(c,"TEXT")).getHash("SHA-256","HEX");a.value=c;$.ajax({type:this.method,url:this.action,data:new FormData(this),processData:!1,contentType:!1,success:function(a){window.location=a.url},error:function(a,c,b){v(a.responseJSON.error_list,L.find("h1"))}});return!1}})}if(-1!==r.indexOf("profile")){var M=/profile\/([^\/]+)/.exec(r)[1],D=$(".own"),E=$(".participated"),I=function(a,c){$.ajax({type:"get",url:"/get_rendered_own_tales",datatype:"json",data:{username:M,offset:a,search_string:c},
success:function(c){D.empty().append(c);D.find("input")[0].focus();D.find("#pagination-buttons button").each(function(){parseInt(this.value,10)===parseInt(a,10)?$(this).addClass("disabled"):$(this).removeClass("disabled")})},error:function(a,c,b){console.log(a)}})},J=function(a,c){$.ajax({type:"get",url:"/get_rendered_participated_tales",datatype:"json",data:{username:M,offset:a,search_string:c},success:function(c){E.empty().append(c);E.find("input")[0].focus();E.find("#pagination-buttons button").each(function(){parseInt(this.value,
10)===parseInt(a,10)?$(this).addClass("disabled"):$(this).removeClass("disabled")})},error:function(a,c,b){console.log(a)}})};D.on("click",".own-pagination",function(a){a.preventDefault();I(this.value,D.find("input")[0].value);return!1});E.on("click",".participated-pagination",function(a){a.preventDefault();J(this.value,E.find("input")[0].value);return!1});I(0);J(0);D.on("submit","form",function(a){a.preventDefault();I(0,$(this).find("input")[0].value);return!1});E.on("submit","form",function(a){a.preventDefault();
J(0,$(this).find("input")[0].value);return!1})}var w=$(".profile");if(-1!==r.indexOf("update/")){var q=$(".button-update-profile");w.on("change",'input[name="update-avatar"]',function(a){if(a=this.files[0]){var c=w.find(".button-choose-file"),b=w.find(".label-choose-file");/\.(jpe?g|png|gif)$/i.test(a.name)?1048576>a.size?(c.addClass("green").html(a.name),b.removeClass("ui red label").html("")):(this.value="",this.files=[],c.removeClass("green").html(n[m].ADD_AVATAR),b.addClass("ui red label").html(n[m].AVATAR_SIZE)):
(this.value="",this.files=[],c.removeClass("green").html(n[m].ADD_AVATAR),b.addClass("ui red label").html(n[m].AVATAR_FORMAT))}});w.on("click",".button-choose-file",function(a){a.preventDefault();w.find('input[name="update-avatar"]').trigger("click");return!1});q.on("click",function(a){$.ajax({type:"get",url:"/get_user_info",datatype:"json",data:{user_id:this.value},success:function(a){w.find("form").remove();w.append(a);w.find("form").form({name:{identifier:"update-name",rules:p.name},email:{identifier:"update-email",
rules:p.email},email_visibility:{identifier:"update-email-visibility",rules:p.empty},biography:{identifier:"update-biography",rules:p.biography}},{inline:!0,onSuccess:function(){$.ajax({type:this.method,url:this.action,data:new FormData(this),processData:!1,contentType:!1,success:function(a){window.location=a.url},error:function(a,c,b){v(a.responseJSON.error_list,w.find("h4"))}});return!1},onFailure:function(){return!1}})},error:function(a,b,d){console.log(a)}})});q.trigger("click");$(".button-update-password").on("click",
function(a){$.ajax({type:"get",url:"/get_update_password_form",datatype:"json",data:{user_id:this.value},success:function(a){w.find("form").remove();w.append(a);var b=$(".password-strength");$('input[name="update-new-password"]').on("keyup",function(a){a=B(this.value);b.removeClass();switch(a){case 0:b.addClass("ui yellow label").html(n[m].TOO_WEAK);break;case 1:b.addClass("ui green label").html(n[m].WEAK);break;case 2:b.addClass("ui blue label").html(n[m].GOOD);break;default:b.addClass("ui red label").html(n[m].STRONG)}});
w.find("form").form({old_password:{identifier:"update-old-password",rules:p.password},new_password:{identifier:"update-new-password",rules:p.password},confirm_new_password:{identifier:"update-confirm-new-password",rules:p.match("update-new-password")}},{inline:!0,onSuccess:function(){var a=$(this).find('input[name="update-old-password"]')[0],c=a.value,c=(new jsSHA(c,"TEXT")).getHash("SHA-256","HEX");a.value=c;a=$(this).find('input[name="update-new-password"]')[0];c=a.value;c=(new jsSHA(c,"TEXT")).getHash("SHA-256",
"HEX");a.value=c;a=$(this).find('input[name="update-confirm-new-password"]')[0];c=a.value;c=(new jsSHA(c,"TEXT")).getHash("SHA-256","HEX");a.value=c;$.ajax({type:this.method,url:this.action,data:new FormData(this),processData:!1,contentType:!1,success:function(a){window.location=a.url},error:function(a,c,b){v(a.responseJSON.error_list,w.find("h4"))}});return!1},onFailure:function(){return!1}})},error:function(a,b,d){console.log(a)}})})}q=$(".upper-bar");0<q.length&&(q.on("submit",".form-unfollow",
function(a){a.preventDefault();var c=$(".form-unfollow"),b=c[0].action;$.ajax({type:"post",url:b,datatype:"json",data:new FormData(this),processData:!1,contentType:!1,success:function(a){c.find("button")[0].innerHTML='<i class="unhide icon"></i>'+n[m].WATCH+" "+a.followers;c.attr("action",b.replace("unfollow","follow"));c.attr("class","form-follow")},error:function(a,c,b){console.log(a)}});return!1}),q.on("submit",".form-follow",function(a){a.preventDefault();var c=$(".form-follow"),b=c[0].action;
$.ajax({type:"post",url:b,datatype:"json",data:new FormData(this),processData:!1,contentType:!1,success:function(a){a.error?window.location=a.error:(c.find("button")[0].innerHTML='<i class="unhide icon"></i>'+n[m].UNWATCH+" "+a.followers,c.attr("action",b.replace("follow","unfollow")),c.attr("class","form-unfollow"))},error:function(a,c,b){console.log(a)}});return!1}),q.on("submit",".form-unstar",function(a){a.preventDefault();var c=$(".form-unstar"),b=c[0].action;$.ajax({type:"post",url:b,datatype:"json",
data:new FormData(this),processData:!1,contentType:!1,success:function(a){c.find("button")[0].innerHTML='<i class="star icon"></i>'+n[m].STAR+" "+a.stars;c.attr("action",b.replace("unstar","star"));c.attr("class","form-star")},error:function(a,c,b){console.log(a)}});return!1}),q.on("submit",".form-star",function(a){a.preventDefault();var c=$(".form-star"),b=c[0].action;$.ajax({type:"post",url:b,datatype:"json",data:new FormData(this),processData:!1,contentType:!1,success:function(a){a.error?window.location=
a.error:(c.find("button")[0].innerHTML='<i class="star icon"></i>'+n[m].UNSTAR+" "+a.stars,c.attr("action",b.replace("star","unstar")),c.attr("class","form-unstar"))},error:function(a,c,b){console.log(a)}});return!1}));if(-1!==r.indexOf("update_tale")){var b=$(".main form");b.form({title:{identifier:"update-tale-title",rules:p.title},description:{identifier:"update-tale-description",rules:p.description},genres:{identifier:"update-tale-genres",rules:[{type:"empty_genres",prompt:n[m].EMPTY}]},license:{identifier:"update-tale-license",
rules:p.checked},type:{identifier:"update-tale-type",rules:p.checked}},{rules:{empty_genres:function(){return 0<$('[name="update-tale-genres"]')[0].children.length}},inline:!0,onSuccess:function(){$.ajax({type:this.method,url:this.action,data:new FormData(this),processData:!1,contentType:!1,success:function(a){window.location=a.url},error:function(a,c,d){v(a.responseJSON.error_list,b.find("h1"))}});return!1}});var q=$("#genres"),e=$('select[name="update-tale-genres"]'),f=$('select[name="available-genres"]');
$("#available-genres").on("keyup",function(a){a=this.value;for(var c=f[0],b=0;b<c.length;b++)0>c[b].innerHTML.indexOf(a)?$(c[b]).attr("hidden","true"):$(c[b]).removeAttr("hidden")});$("#taken-genres").on("keyup",function(a){a=this.value;for(var c=e[0],b=0;b<c.length;b++)0>c[b].innerHTML.indexOf(a)?$(c[b]).attr("hidden","true"):$(c[b]).removeAttr("hidden")});$("#add").on("click",function(a){a=f.find("option:selected");for(var c=0;c<a.length;c++)e.append(a[c])});$("#remove").on("click",function(a){a=
e.find("option:selected");for(var c=0;c<a.length;c++)f.append(a[c])});q.on("dblclick",'select[name="update-tale-genres"] option',function(a){f.append(this);e.find("option").each(function(){$(this).attr("selected","selected")})});q.on("dblclick",'select[name="available-genres"] option',function(a){e.append(this)})}$(".results");if(-1!==r.indexOf("search")){$("#layout-search-bar").empty();$('input[name="content"]').focus();var d=$(".main-block"),h=1;$.ajax({type:"get",url:"/search_tales"+window.location.search,
datatype:"json",success:function(a){d.empty().append(a)},error:function(a,c,b){console.log(a)}});var l=function(a,c){$.ajax({type:"get",url:a,datatype:"json",data:{"sort-value":c},success:function(c){d.empty().append(c);h=a.indexOf("tales")},error:function(a,c,b){console.log(a)}})};$(".search-block").on("click",".search-tales, .search-users",function(a){a.preventDefault();l(this.href,1);return!1});d.on("change","#sort-bar",function(a){a="";a=0<=h?$(".search-tales")[0].href:$(".search-users")[0].href;
l(a,$(this).find("option:selected")[0].value)})}var k=$(".contribution-requests");if(-1!==r.indexOf("contribution_requests")){var P=/contribution_requests\/([0-9]+)/.exec(window.location)[1],N=$(".o-c-r"),O=$(".c-c-r");N.on("click",function(a){1!==k.find(".open-contribution-requests").length&&(console.log("HERE"),N.addClass("active"),O.removeClass("active"),$.ajax({type:"get",url:"/get_open_contribution_requests",datatype:"json",data:{tale_id:P},success:function(a){k.find(".closed-contribution-requests").remove();
k.append(a)},error:function(a,b,d){console.log(a)}}))});N.trigger("click");O.on("click",function(a){1!==k.find(".closed-contribution-requests").length&&(O.addClass("active"),N.removeClass("active"),$.ajax({type:"get",url:"/get_closed_contribution_requests",datatype:"json",data:{tale_id:P},success:function(a){k.find(".open-contribution-requests").remove();k.append(a)},error:function(a,b,d){console.log(a)}}))})}if(-1!==r.indexOf("create")){var Q=$(".create form");Q.form({title:{identifier:"create-title",
rules:p.title},description:{identifier:"create-description",rules:p.description},genres:{identifier:"create-genres",rules:[{type:"empty_genres",prompt:n[m].EMPTY}]},license:{identifier:"create-license",rules:p.checked},type:{identifier:"create-type",rules:p.checked}},{rules:{empty_genres:function(){return 0<$('[name="create-genres"]')[0].children.length}},inline:!0,onSuccess:function(){$.ajax({type:this.method,url:this.action,data:new FormData(this),processData:!1,contentType:!1,success:function(a){window.location=
a.url},error:function(a,b,d){v(a.responseJSON.error_list,Q.find("h1"))}});return!1}});var q=$("#genres"),K=$('select[name="create-genres"]'),f=$('select[name="available-genres"]');$("#available-genres").on("keyup",function(a){a=this.value;for(var b=f[0],d=0;d<b.length;d++)0>b[d].innerHTML.indexOf(a)?$(b[d]).attr("hidden","true"):$(b[d]).removeAttr("hidden")});$("#taken-genres").on("keyup",function(a){a=this.value;for(var b=K[0],d=0;d<b.length;d++)0>b[d].innerHTML.indexOf(a)?$(b[d]).attr("hidden",
"true"):$(b[d]).removeAttr("hidden")});$("#add").on("click",function(a){a=f.find("option:selected");for(var b=0;b<a.length;b++)K.append(a[b])});$("#remove").on("click",function(a){a=K.find("option:selected");for(var b=0;b<a.length;b++)f.append(a[b])});q.on("dblclick",'select[name="create-genres"] option',function(a){f.append(this);K.find("option").each(function(){$(this).attr("selected","selected")})});q.on("dblclick",'select[name="available-genres"] option',function(a){K.append(this)})}if(-1!==r.indexOf("contribute")){var g=
$(".contribute-form");tinymce.init({selector:'textarea[name="contribute-content"]'});g.form({title:{identifier:"contribute-title",rules:p.title}},{inline:!0,onSuccess:function(){$.ajax({type:this.method,url:this.action,data:{"contribute-title":g.find('[name="contribute-title"]')[0].value,"contribute-content":tinymce.get("contribute-content").getContent(),_csrf_token:g.find('[name="_csrf_token"]')[0].value},success:function(a){window.location=a.url},error:function(a,b,d){v(a.responseJSON.error_list,
g.find("h1"))}});return!1}})}if(-1!==r.indexOf("settings"))$("#form-delete").on("submit",function(a){a.preventDefault();a=$(this).find("button")[0].value;var b=prompt(n[m].DELETE_MODAL_MESSAGE);b&&(b===a?$.ajax({type:this.method,url:this.action,datatype:"json",data:new FormData(this),processData:!1,contentType:!1,success:function(a){window.location=a.url},error:function(a,b,c){console.log(a)}}):($(this).find("div").remove(),$(this).append('<div class="ui red message">'+n[m].DELETE_MODAL_WRONG_TITLE+
"</div>")));return!1})});"use strict";
(function(m){function r(b,e,f){var d=0,h=[0],l="",k=null,l=f||"UTF8";if("UTF8"!==l&&"UTF16BE"!==l&&"UTF16LE"!==l)throw"encoding must be UTF8, UTF16BE, or UTF16LE";if("HEX"===e){if(0!==b.length%2)throw"srcString of HEX type must be in byte increments";k=p(b);d=k.binLen;h=k.value}else if("TEXT"===e)k=n(b,l),d=k.binLen,h=k.value;else if("B64"===e)k=v(b),d=k.binLen,h=k.value;else if("BYTES"===e)k=B(b),d=k.binLen,h=k.value;else throw"inputFormat must be HEX, TEXT, B64, or BYTES";this.getHash=function(b,
e,f,k){var l=null,g=h.slice(),a=d,c;3===arguments.length?"number"!==typeof f&&(k=f,f=1):2===arguments.length&&(f=1);if(f!==parseInt(f,10)||1>f)throw"numRounds must a integer >= 1";switch(e){case "HEX":l=A;break;case "B64":l=y;break;case "BYTES":l=z;break;default:throw"format must be HEX, B64, or BYTES";}if("SHA-224"===b)for(c=0;c<f;c+=1)g=q(g,a,b),a=224;else if("SHA-256"===b)for(c=0;c<f;c+=1)g=q(g,a,b),a=256;else throw"Chosen SHA variant is not supported";return l(g,C(k))};this.getHMAC=function(b,
e,f,k,m){var g,a,c,t,r=[],u=[];switch(k){case "HEX":k=A;break;case "B64":k=y;break;case "BYTES":k=z;break;default:throw"outputFormat must be HEX, B64, or BYTES";}if("SHA-224"===f)a=64,t=224;else if("SHA-256"===f)a=64,t=256;else throw"Chosen SHA variant is not supported";if("HEX"===e)g=p(b),c=g.binLen,g=g.value;else if("TEXT"===e)g=n(b,l),c=g.binLen,g=g.value;else if("B64"===e)g=v(b),c=g.binLen,g=g.value;else if("BYTES"===e)g=B(b),c=g.binLen,g=g.value;else throw"inputFormat must be HEX, TEXT, B64, or BYTES";
b=8*a;e=a/4-1;if(a<c/8){for(g=q(g,c,f);g.length<=e;)g.push(0);g[e]&=4294967040}else if(a>c/8){for(;g.length<=e;)g.push(0);g[e]&=4294967040}for(a=0;a<=e;a+=1)r[a]=g[a]^909522486,u[a]=g[a]^1549556828;f=q(u.concat(q(r.concat(h),b+d,f)),b+t,f);return k(f,C(m))}}function n(b,e){var f=[],d,h=[],l=0,k,m,n;if("UTF8"===e)for(k=0;k<b.length;k+=1)for(d=b.charCodeAt(k),h=[],128>d?h.push(d):2048>d?(h.push(192|d>>>6),h.push(128|d&63)):55296>d||57344<=d?h.push(224|d>>>12,128|d>>>6&63,128|d&63):(k+=1,d=65536+((d&
1023)<<10|b.charCodeAt(k)&1023),h.push(240|d>>>18,128|d>>>12&63,128|d>>>6&63,128|d&63)),m=0;m<h.length;m+=1){for(n=l>>>2;f.length<=n;)f.push(0);f[n]|=h[m]<<24-l%4*8;l+=1}else if("UTF16BE"===e||"UTF16LE"===e)for(k=0;k<b.length;k+=1){d=b.charCodeAt(k);"UTF16LE"===e&&(m=d&255,d=m<<8|d>>8);for(n=l>>>2;f.length<=n;)f.push(0);f[n]|=d<<16-l%4*8;l+=2}return{value:f,binLen:8*l}}function p(b){var e=[],f=b.length,d,h,l;if(0!==f%2)throw"String of HEX type must be in byte increments";for(d=0;d<f;d+=2){h=parseInt(b.substr(d,
2),16);if(isNaN(h))throw"String of HEX type contains invalid characters";for(l=d>>>3;e.length<=l;)e.push(0);e[d>>>3]|=h<<24-d%8*4}return{value:e,binLen:4*f}}function B(b){var e=[],f,d,h;for(d=0;d<b.length;d+=1)f=b.charCodeAt(d),h=d>>>2,e.length<=h&&e.push(0),e[h]|=f<<24-d%4*8;return{value:e,binLen:8*b.length}}function v(b){var e=[],f=0,d,h,l,k,m;if(-1===b.search(/^[a-zA-Z0-9=+\/]+$/))throw"Invalid character in base-64 string";h=b.indexOf("=");b=b.replace(/\=/g,"");if(-1!==h&&h<b.length)throw"Invalid '=' found in base-64 string";
for(h=0;h<b.length;h+=4){m=b.substr(h,4);for(l=k=0;l<m.length;l+=1)d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(m[l]),k|=d<<18-6*l;for(l=0;l<m.length-1;l+=1){for(d=f>>>2;e.length<=d;)e.push(0);e[d]|=(k>>>16-8*l&255)<<24-f%4*8;f+=1}}return{value:e,binLen:8*f}}function A(b,e){var f="",d=4*b.length,h,l;for(h=0;h<d;h+=1)l=b[h>>>2]>>>8*(3-h%4),f+="0123456789abcdef".charAt(l>>>4&15)+"0123456789abcdef".charAt(l&15);return e.outputUpper?f.toUpperCase():f}function y(b,e){var f=
"",d=4*b.length,h,l,k;for(h=0;h<d;h+=3)for(k=h+1>>>2,l=b.length<=k?0:b[k],k=h+2>>>2,k=b.length<=k?0:b[k],k=(b[h>>>2]>>>8*(3-h%4)&255)<<16|(l>>>8*(3-(h+1)%4)&255)<<8|k>>>8*(3-(h+2)%4)&255,l=0;4>l;l+=1)f=8*h+6*l<=32*b.length?f+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k>>>6*(3-l)&63):f+e.b64Pad;return f}function z(b){var e="",f=4*b.length,d,h;for(d=0;d<f;d+=1)h=b[d>>>2]>>>8*(3-d%4)&255,e+=String.fromCharCode(h);return e}function C(b){var e={outputUpper:!1,b64Pad:"="};
try{b.hasOwnProperty("outputUpper")&&(e.outputUpper=b.outputUpper),b.hasOwnProperty("b64Pad")&&(e.b64Pad=b.b64Pad)}catch(f){}if("boolean"!==typeof e.outputUpper)throw"Invalid outputUpper formatting option";if("string"!==typeof e.b64Pad)throw"Invalid b64Pad formatting option";return e}function u(b,e){return b>>>e|b<<32-e}function F(b,e,f){return b&e^~b&f}function H(b,e,f){return b&e^b&f^e&f}function L(b){return u(b,2)^u(b,13)^u(b,22)}function M(b){return u(b,6)^u(b,11)^u(b,25)}function D(b){return u(b,
7)^u(b,18)^b>>>3}function E(b){return u(b,17)^u(b,19)^b>>>10}function I(b,e){var f=(b&65535)+(e&65535);return((b>>>16)+(e>>>16)+(f>>>16)&65535)<<16|f&65535}function J(b,e,f,d){var h=(b&65535)+(e&65535)+(f&65535)+(d&65535);return((b>>>16)+(e>>>16)+(f>>>16)+(d>>>16)+(h>>>16)&65535)<<16|h&65535}function w(b,e,f,d,h){var l=(b&65535)+(e&65535)+(f&65535)+(d&65535)+(h&65535);return((b>>>16)+(e>>>16)+(f>>>16)+(d>>>16)+(h>>>16)+(l>>>16)&65535)<<16|l&65535}function q(b,e,f){var d,h,l,k,m,n,p,r,q,g,a,c,t,u,
v,x,y,z,A,B,C,R,S,T,U,G=[],V,W=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,
3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];g=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428];h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];if("SHA-224"===f||"SHA-256"===f)a=64,d=(e+65>>>9<<4)+15,u=16,v=1,U=Number,x=I,y=J,z=w,A=D,B=E,C=L,R=M,T=H,
S=F,g="SHA-224"===f?g:h;else throw"Unexpected error in SHA-2 implementation";for(;b.length<=d;)b.push(0);b[e>>>5]|=128<<24-e%32;b[d]=e;V=b.length;for(c=0;c<V;c+=u){e=g[0];d=g[1];h=g[2];l=g[3];k=g[4];m=g[5];n=g[6];p=g[7];for(t=0;t<a;t+=1)16>t?(q=t*v+c,r=b.length<=q?0:b[q],q=b.length<=q+1?0:b[q+1],G[t]=new U(r,q)):G[t]=y(B(G[t-2]),G[t-7],A(G[t-15]),G[t-16]),r=z(p,R(k),S(k,m,n),W[t],G[t]),q=x(C(e),T(e,d,h)),p=n,n=m,m=k,k=x(l,r),l=h,h=d,d=e,e=x(r,q);g[0]=x(e,g[0]);g[1]=x(d,g[1]);g[2]=x(h,g[2]);g[3]=x(l,
g[3]);g[4]=x(k,g[4]);g[5]=x(m,g[5]);g[6]=x(n,g[6]);g[7]=x(p,g[7])}if("SHA-224"===f)b=[g[0],g[1],g[2],g[3],g[4],g[5],g[6]];else if("SHA-256"===f)b=g;else throw"Unexpected error in SHA-2 implementation";return b}"function"===typeof define&&define.amd?define(function(){return r}):"undefined"!==typeof exports?"undefined"!==typeof module&&module.exports?module.exports=exports=r:exports=r:m.jsSHA=r})(this);